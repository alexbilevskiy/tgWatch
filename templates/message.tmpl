{{define "message"}}
    {{if eq .needHeader true}}
        {{if eq .chat.Type "User"}}
            <li class="list-group-item {{if isMe .parent.SenderId}}list-group-item-secondary{{else}}{{end}}">
        {{else}}
            <li class="list-group-item">
            {{if eq .needSender true}}
                <a href="/c/{{.parent.SenderId}}">{{.parent.SenderName}}</a><br>
            {{end}}
        {{end}}
    {{end}}

    {{if .parent.FormattedText}}
        {{.parent.FormattedText | renderText}}
    {{end}}
    {{if .parent.SimpleText}}
        {{.parent.SimpleText}}
    {{end}}

    {{$attachmentsCount := .parent.Attachments | len}}
    {{if gt $attachmentsCount 0}}
        {{if eq .needHeader true}}<br>{{end}}
        {{range .parent.Attachments}}
            <a href="/f/{{.Id}}">
                {{if .Thumb}}
                    <img src="data:image/png;base64, {{.Thumb}}" title="{{.T}}" alt=""/>
                {{else}}
                    link
                {{end}}
            </a>
        {{end}}
    {{end}}

    {{if eq .needHeader true}}
        <small>
            <span class="float-end" title="{{.parent.DateTimeStr}}">
                <a class="link-secondary" href="/m/{{.chat.ChatId}}/{{.parent.MessageId}}">{{.parent.TimeStr}}</a>
            </span>
        </small>
    {{end}}

    {{if eq .needFooter true}}
        </li>
    {{end}}
{{end}}